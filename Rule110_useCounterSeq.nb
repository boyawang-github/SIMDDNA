(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80658,       2037]
NotebookOptionsPosition[     73618,       1925]
NotebookOutlinePosition[     74017,       1941]
CellTagsIndexPosition[     73974,       1938]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions", "Section",
 CellChangeTimes->{{3.8170712981193542`*^9, 3.8170713090631933`*^9}, {
  3.893295459654598*^9, 
  3.8932954615561047`*^9}},ExpressionUUID->"267bf28b-396c-440e-9cbe-\
a63cadce32a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRepeats", "[", "s_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"SortBy", "[", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"StringCases", "[", 
      RowBox[{"s", ",", 
       RowBox[{
        RowBox[{"r__", "~~", "___", "~~", "r__"}], "\[Rule]", "r"}], ",", 
       RowBox[{"Overlaps", "\[Rule]", "All"}]}], "]"}], "]"}], ",", 
    "StringLength"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642088315496846*^9, 3.642088399768015*^9}, 
   3.642095899359642*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"6118c5e8-4ea0-4a7b-b558-866799167c87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"repeatLength", "[", "s_", "]"}], ":=", 
  RowBox[{"StringLength", "[", 
   RowBox[{"Last", "[", 
    RowBox[{"findRepeats", "[", "s", "]"}], "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[165]:=",ExpressionUUID->"d2d7097c-20f6-49df-b615-a3970312c8c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runLengthAT", "[", "s_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"StringLength", "/@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<A\>\"", "|", "\"\<T\>\""}], ")"}], ".."}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[166]:=",ExpressionUUID->"2780ea47-88f7-4847-8fc8-50f4b3dfd3c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runLengthA", "[", "s_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"StringLength", "/@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"(", "\"\<A\>\"", ")"}], ".."}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642190896285941*^9, 3.6421909007570066`*^9}, {
  3.6421909594818974`*^9, 3.642190963427691*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"329772c4-1159-49c0-bcca-fd2f4ae817d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runLengthT", "[", "s_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"StringLength", "/@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"(", "\"\<T\>\"", ")"}], ".."}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642190970213277*^9, 3.6421909734170933`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"b85b94fe-3632-4a21-b783-1dc233785b2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runLengthC", "[", "s_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"StringLength", "/@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"(", "\"\<C\>\"", ")"}], ".."}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8158781098769703`*^9, 3.8158781127797337`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"e2405bd8-7d3d-4ad9-a795-307e66258ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runLengthG", "[", "s_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"StringLength", "/@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"(", "\"\<G\>\"", ")"}], ".."}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815878123408738*^9, 3.815878127364316*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"048c0672-958a-4687-8862-3e38dfa39155"],

Cell[BoxData[
 RowBox[{
  RowBox[{"runLengthCG", "[", "s_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"StringLength", "/@", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<C\>\"", "|", "\"\<G\>\""}], ")"}], ".."}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"6e10166b-af4c-43af-882f-a261f1172ca4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fractionCG", "[", "s_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"StringCases", "[", 
      RowBox[{"s", ",", 
       RowBox[{"\"\<C\>\"", "|", "\"\<G\>\""}]}], "]"}], "]"}], "/", 
    RowBox[{"StringLength", "[", "s", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642090276123761*^9, 3.642090277259768*^9}, {
  3.642097417743112*^9, 3.642097419320281*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"68372a18-4d98-42ca-8904-fc99eaf1b2db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"complement", "[", "s_", "]"}], ":=", 
  RowBox[{"StringReverse", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<T\>\""}], ",", 
       RowBox[{"\"\<T\>\"", "\[Rule]", "\"\<A\>\""}], ",", 
       RowBox[{"\"\<G\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", "\"\<G\>\""}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6420974224157553`*^9, 3.642097448378207*^9}, {
  3.6420975424853487`*^9, 3.6420975913574057`*^9}, {3.6420976643699503`*^9, 
  3.642097667005723*^9}, {3.6468467590433397`*^9, 3.646846762710421*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"4aa3c7f4-b730-45bb-af0a-82c56c788e7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "nupackPath", "=", 
   "\"\</Users/WangBoya/Research/Research_Tools/nupack3.0.6\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetEnvironment", "[", 
   RowBox[{"\"\<NUPACKHOME\>\"", "\[Rule]", "nupackPath"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{3.736703457118626*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"2de1d091-e489-410f-b93c-524b83141084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"viennarnaPATH", "=", "\"\</usr/local/share/ViennaRNA/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetEnvironment", "[", 
   RowBox[{"\"\<VIENNARNA_PARAMS_PATH\>\"", "\[Rule]", "viennarnaPATH"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "viennafolder", "=", 
   "\"\</Users/wangboya/Research/Research_Tools/ViennaRNA-2.4.17/\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8172157679334507`*^9, 3.817215847162861*^9}, {
  3.81721598469767*^9, 3.817215990594751*^9}, {3.817216103761153*^9, 
  3.817216106651556*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"eb1bed4a-eda9-4ef1-9a52-81362ef12199"],

Cell["\<\
energySelf[s] gives the deltaG of the input sequence itself (by running \
nupack). \
\>", "Text",
 CellChangeTimes->{{3.64684726696513*^9, 3.646847288866497*^9}, {
  3.646920548607176*^9, 3.646920674592484*^9}, {3.760066215228709*^9, 
  3.760066219355981*^9}, {3.760211384222073*^9, 3.7602114053430967`*^9}, {
  3.760211443634701*^9, 
  3.760211443944021*^9}},ExpressionUUID->"f01743f1-a69d-417f-b6d0-\
b108f31bd023"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energySelf", "[", "s_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"process", "=", 
       RowBox[{"StartProcess", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nupackPath", "<>", "\"\</bin/pfunc\>\""}], ",", " ", 
          "\"\<-T\>\"", ",", " ", "\"\<25\>\"", ",", " ", "\"\<-material\>\"",
           ",", " ", "\"\<dna\>\""}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "deltaG"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"send", " ", "first", " ", 
      RowBox[{"line", "--"}], "sequence"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "s"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wait", " ", "until", " ", "Nupack", " ", "finishes"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WaitUntil", "[", 
      RowBox[{"ProcessStatus", "[", 
       RowBox[{"process", ",", "\"\<Finished\>\""}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Read", " ", "the", " ", "last", " ", "but", " ", "one", " ", "line", 
       " ", "of", " ", 
       RowBox[{"output", " ", "--"}], " ", "this", " ", "is", " ", "where", 
       " ", "deltaG", " ", "is"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"deltaG", "=", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"ReadString", "[", 
          RowBox[{"process", ",", "EndOfBuffer"}], "]"}], ",", 
         "\"\<\\n\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Kill", " ", "the", " ", "Nupack", " ", "process", " ", 
       RowBox[{"(", 
        RowBox[{"just", " ", "in", " ", "case"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"KillProcess", "[", "process", "]"}], ";", "\[IndentingNewLine]",
      "deltaG"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367036515289087`*^9, 3.736703666131159*^9}, {
   3.73670416411306*^9, 3.736704198201352*^9}, {3.736704375447946*^9, 
   3.736704379246207*^9}, 3.7367044560945807`*^9, {3.736704843231859*^9, 
   3.736704846809873*^9}, {3.760065846874651*^9, 3.760065854364921*^9}, {
   3.760067764907436*^9, 3.760067767706614*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"8d2b10a0-f813-4c2a-a484-9335bb92f774"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energyComp", "[", "s_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"process", "=", 
       RowBox[{"StartProcess", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nupackPath", "<>", "\"\</bin/energy\>\""}], ",", " ", 
          "\"\<-T\>\"", ",", " ", "\"\<25\>\"", ",", " ", "\"\<-material\>\"",
           ",", " ", "\"\<dna\>\""}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "deltaG"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"send", " ", "first", " ", 
      RowBox[{"line", ":", " ", 
       RowBox[{
        RowBox[{"eg", " ", "ATGGA"}], "+", "TCCAT"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", 
       RowBox[{"s", "<>", "\"\<+\>\"", "<>", 
        RowBox[{"complement", "[", "s", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "second", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{"eg", " ", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{"(", 
             RowBox[{"(", "+", ")"}], ")"}], ")"}], ")"}], ")"}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", 
       RowBox[{
        RowBox[{"StringRepeat", "[", 
         RowBox[{"\"\<(\>\"", ",", 
          RowBox[{"StringLength", "[", "s", "]"}]}], "]"}], "<>", "\"\<+\>\"",
         "<>", 
        RowBox[{"StringRepeat", "[", 
         RowBox[{"\"\<)\>\"", ",", 
          RowBox[{"StringLength", "[", "s", "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wait", " ", "until", " ", "Nupack", " ", "finishes"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WaitUntil", "[", 
      RowBox[{"ProcessStatus", "[", 
       RowBox[{"process", ",", "\"\<Finished\>\""}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Read", " ", "last", " ", "line", " ", "of", " ", 
       RowBox[{"output", " ", "--"}], " ", "this", " ", "is", " ", "where", 
       " ", "deltaG", " ", "is"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"deltaG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"ReadString", "[", 
           RowBox[{"process", ",", "EndOfBuffer"}], "]"}], ",", 
          "\"\<\\n\>\""}], "]"}], "//", "Last"}], "//", "ToExpression"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Kill", " ", "the", " ", "Nupack", " ", "process", " ", 
       RowBox[{"(", 
        RowBox[{"just", " ", "in", " ", "case"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"KillProcess", "[", "process", "]"}], ";", "\[IndentingNewLine]",
      "deltaG"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.646843604105164*^9, 3.646843699224298*^9}, {
   3.646843757330405*^9, 3.64684375865906*^9}, {3.6468439303009043`*^9, 
   3.646844066325931*^9}, {3.646844123450609*^9, 3.646844157311781*^9}, {
   3.646844934888504*^9, 3.6468451846998587`*^9}, 3.646845222467063*^9, {
   3.646845258288707*^9, 3.646845268432214*^9}, {3.646845493660995*^9, 
   3.646845545770032*^9}, {3.646845575987555*^9, 3.646845590497563*^9}, {
   3.646845625680531*^9, 3.646845641519882*^9}, {3.6468457152861547`*^9, 
   3.646845726934156*^9}, {3.646845785837322*^9, 3.6468457987805347`*^9}, {
   3.64684586935709*^9, 3.646845872690936*^9}, {3.6468459161464653`*^9, 
   3.646845956985615*^9}, {3.6468460633731737`*^9, 3.6468460777481823`*^9}, {
   3.646846119012128*^9, 3.646846133109433*^9}, {3.646846166158156*^9, 
   3.646846167027039*^9}, {3.6468462996037073`*^9, 3.6468463541754293`*^9}, {
   3.646846436839006*^9, 3.6468464552467012`*^9}, {3.6468465232447577`*^9, 
   3.646846589731627*^9}, {3.646847299870265*^9, 3.6468473006742477`*^9}, {
   3.6468783339816027`*^9, 3.6468783382891483`*^9}, {3.646878466343705*^9, 
   3.646878480209982*^9}, 3.646916632634165*^9, {3.6469206871023808`*^9, 
   3.646920694707088*^9}, 3.646920731222703*^9, {3.6469208903558693`*^9, 
   3.646920986013116*^9}, {3.760066208670535*^9, 3.7600662249099207`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"58a5295c-9b4a-44f4-a0d8-abef53ae1856"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy2strand", "[", 
   RowBox[{"s_", ",", "k_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"process", "=", 
       RowBox[{"StartProcess", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nupackPath", "<>", "\"\</bin/pfunc\>\""}], ",", " ", 
          "\"\<-T\>\"", ",", " ", "\"\<25\>\"", ",", "\"\<-multi\>\"", ",", 
          " ", "\"\<-material\>\"", ",", " ", "\"\<dna\>\""}], "}"}], "]"}]}],
       ",", "\[IndentingNewLine]", "deltaG"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"send", " ", "1", "st", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{"#", " ", "of", " ", "strands"}]}]}], ",", " ", "2"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "\"\<2\>\""}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "2", "nd", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{"strand", " ", "s"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "s"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "3", "rd", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{"strand", " ", "k"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "k"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "4", "th", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{"strand", " ", "permutation"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "\"\<1 2\>\""}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wait", " ", "until", " ", "Nupack", " ", "finishes"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WaitUntil", "[", 
      RowBox[{"ProcessStatus", "[", 
       RowBox[{"process", ",", "\"\<Finished\>\""}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Read", " ", "the", " ", "last", " ", "but", " ", "one", " ", "line", 
       " ", "of", " ", 
       RowBox[{"output", " ", "--"}], " ", "this", " ", "is", " ", "where", 
       " ", "deltaG", " ", "is"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"deltaG", "=", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"ReadString", "[", 
          RowBox[{"process", ",", "EndOfBuffer"}], "]"}], ",", 
         "\"\<\\n\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Kill", " ", "the", " ", "Nupack", " ", "process", " ", 
       RowBox[{"(", 
        RowBox[{"just", " ", "in", " ", "case"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"KillProcess", "[", "process", "]"}], ";", "\[IndentingNewLine]",
      "deltaG"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.760068063226674*^9, 3.760068181473082*^9}, {
  3.760068256353517*^9, 3.760068257231098*^9}, {3.760068296370801*^9, 
  3.760068314122157*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"53a0fdea-377f-4484-b61a-258bad5a11a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vienna2strand", "[", 
   RowBox[{"s_", ",", "k_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"process", "=", 
       RowBox[{"StartProcess", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"viennafolder", "<>", "\"\<src/bin/RNAduplex\>\""}], ",", 
          "\"\<-P\>\"", ",", 
          RowBox[{"viennarnaPATH", "<>", "\"\<dna_mathews1999.par\>\""}], 
          ",", "\"\<-T\>\"", ",", "\"\<25\>\"", ",", "\"\<--noGU\>\""}], 
         "}"}], "]"}]}], ",", "\[IndentingNewLine]", "deltaG"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"send", " ", "1", "st", " ", 
      RowBox[{"line", ":", " ", 
       RowBox[{"strand", " ", "s"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "s"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "2", "nd", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{"strand", " ", "k"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "k"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "3", "nd", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{
        "\"\<@\>\"", " ", "to", " ", "kill", " ", "the", " ", "process"}]}]}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "\"\<@\>\""}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wait", " ", "until", " ", "ViennaRNA", " ", "finishes"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WaitUntil", "[", 
      RowBox[{"ProcessStatus", "[", 
       RowBox[{"process", ",", "\"\<Finished\>\""}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Read", " ", "the", " ", "last", " ", "but", " ", "one", " ", "line", 
       " ", "of", " ", 
       RowBox[{"output", " ", "--"}], " ", "this", " ", "is", " ", "where", 
       " ", "deltaG", " ", "is"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"deltaG", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"ReadString", "[", 
         RowBox[{"process", ",", "EndOfBuffer"}], "]"}], ",", "\"\<\\n\>\""}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Kill", " ", "the", " ", "viennaRNA", " ", "process", " ", 
       RowBox[{"(", 
        RowBox[{"just", " ", "in", " ", "case"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"KillProcess", "[", "process", "]"}], ";", "\[IndentingNewLine]",
      "deltaG"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81721680296061*^9, 3.8172168928152313`*^9}, {
   3.817217387266933*^9, 3.81721738783751*^9}, {3.817217809220141*^9, 
   3.817217812930567*^9}, {3.817217888470969*^9, 3.817217917340207*^9}, {
   3.817218206944668*^9, 3.8172182282220287`*^9}, {3.817218266165962*^9, 
   3.817218275592289*^9}, {3.81725153661819*^9, 3.8172515662987013`*^9}, {
   3.8172516832362413`*^9, 3.817251684415648*^9}, 3.817251802031088*^9, 
   3.817252569084828*^9},
 CellLabel->
  "In[182]:=",ExpressionUUID->"dcb3e41e-ea8a-4d53-8a61-a089516f811c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"viennamulti", "[", "s_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"process", "=", 
       RowBox[{"StartProcess", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"viennafolder", "<>", "\"\<src/bin/RNAduplex\>\""}], ",", 
          "\"\<-P\>\"", ",", 
          RowBox[{"viennarnaPATH", "<>", "\"\<dna_mathews1999.par\>\""}], 
          ",", "\"\<-T\>\"", ",", "\"\<25\>\"", ",", "\"\<--noGU\>\""}], 
         "}"}], "]"}]}], ",", "\[IndentingNewLine]", "deltaG"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WriteLine", "[", 
        RowBox[{"process", ",", 
         RowBox[{"s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"send", " ", "the", " ", "last", " ", 
       RowBox[{"line", ":", " ", 
        RowBox[{
        "\"\<@\>\"", " ", "to", " ", "kill", " ", "the", " ", "process"}]}]}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{"process", ",", "\"\<@\>\""}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wait", " ", "until", " ", "ViennaRNA", " ", "finishes"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WaitUntil", "[", 
      RowBox[{"ProcessStatus", "[", 
       RowBox[{"process", ",", "\"\<Finished\>\""}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Read", " ", "the", " ", "last", " ", "but", " ", "one", " ", "line", 
       " ", "of", " ", 
       RowBox[{"output", " ", "--"}], " ", "this", " ", "is", " ", "where", 
       " ", "deltaG", " ", "is"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"deltaG", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"ReadString", "[", 
         RowBox[{"process", ",", "EndOfBuffer"}], "]"}], ",", "\"\<\\n\>\""}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Kill", " ", "the", " ", "viennaRNA", " ", "process", " ", 
       RowBox[{"(", 
        RowBox[{"just", " ", "in", " ", "case"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"KillProcess", "[", "process", "]"}], ";", "\[IndentingNewLine]",
      "deltaG"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8172185378974037`*^9, 3.8172186432875223`*^9}, 
   3.817251809650605*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"e0120a62-d3da-4890-b831-867b4acdfced"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sequence information from the binary counting program", "Section",
 CellChangeTimes->{{3.817073499649378*^9, 3.8170735275652103`*^9}, {
  3.8171430406092377`*^9, 3.817143042592967*^9}, {3.81878133905928*^9, 
  3.818781349043003*^9}},ExpressionUUID->"62792cea-b56e-4fe3-8c82-\
c02ef0753f54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"seq", " ", "is", " ", "for", " ", "top", " ", 
    RowBox[{"strand", " ", "--"}], " ", "because", " ", "I", " ", "want", " ",
     "the", " ", "top", " ", "strand", " ", "to", " ", "have", " ", "ATG", 
    " ", 
    RowBox[{"alphabet", " ", "--"}], " ", "in", " ", "order", " ", "to", " ", 
    "use", " ", "make", " ", "mismatches", " ", "on", " ", "the", " ", "top", 
    " ", 
    RowBox[{"strand", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "but", " ", "i", " ", "have", " ", "to", " ", "take", " ", "the", " ", 
    "bottom", " ", "strand"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "seq", "=", 
    "\"\<GATTAAGGATTTGAAGTTTTGTGAAATGGAATGATGATTGTGAGATTGGTGTTTGGTTATGTAGTGGAG\
TAGAGAGAGTTAGGTTGAAGGAGAAAGGTTTGTTGATAGATGTTTGAGTAAATGTGTGTGTAGGAGATGTAAAGGTAT\
GTGTGAGTTGGAAGTGAGAGTTGTAGAAAGAAGGATGAAGAAAAG\>\""}], ";"}]}]], "Input",
 CellLabel->
  "In[193]:=",ExpressionUUID->"68d60c30-8925-43b2-85a6-3492cdfbe16b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Comseq", "=", 
    RowBox[{"complement", "[", "seq", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"seq", " ", 
     RowBox[{"(", "top", ")"}]}], ":", " ", 
    RowBox[{"<", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"toehold", "--"}]}], 
       RowBox[{"a", "--"}], 
       RowBox[{"b", "--"}], 
       RowBox[{"extraLeft", "--"}], 
       RowBox[{
        RowBox[{"1", "--"}], "--"}]}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "--"}], "--"}], "--"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"3", "--"}], "--"}], "--"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"4", "--"}], "--"}], 
       RowBox[{"rightmost", "--"}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"com", " ", 
     RowBox[{"(", "bot", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"toehold", "--"}]}], 
       RowBox[{"a", "--"}], 
       RowBox[{"b", "--"}], 
       RowBox[{"extraLeft", "--"}], 
       RowBox[{
        RowBox[{"1", "--"}], "--"}]}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "--"}], "--"}], "--"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"3", "--"}], "--"}], "--"}], "-", 
      RowBox[{
       RowBox[{"4", "--"}], "--"}], "-", 
      RowBox[{"rightmost", "--"}]}], ">"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Alldomains", "=", 
   RowBox[{"StringTake", "[", 
    RowBox[{"Comseq", ",", 
     RowBox[{
      RowBox[{"28", "*", "7"}], "-", "4"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "take", " ", "the", " ", "all", " ", "domains", " ", "from", " ", 
     "complementary"}], ",", " ", 
    RowBox[{"including", " ", "domain", " ", "a"}], ",", "b"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"bottom", "=", 
  RowBox[{"StringTake", "[", 
   RowBox[{"Comseq", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "*", "7"}], "+", "1"}], ",", 
      RowBox[{
       RowBox[{"28", "*", "7"}], "-", "4"}]}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "take", " ", "the", " ", "last", " ", "XX", " ", "domains", " ", "from", 
     " ", "seq"}], ",", " ", 
    RowBox[{"NOT", " ", "including", " ", "domain", " ", "a"}], ",", "b"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.818780976761303*^9, 3.8187809997802677`*^9}, 
   3.818781373967299*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"16922e85-8cb3-4839-9d16-3971a8c52db6"],

Cell[BoxData["\<\"\
CTTTTCTTCATCCTTCTTTCTACAACTCTCACTTCCAACTCACACATACCTTTACATCTCCTACACACACATTTACTC\
AAACATCTATCAACAAACCTTTCTCCTTCAACCTAACTCTCTCTACTCCACTACATAACCAAACACCAATCTCACAAT\
CATCATTCCATTTCACAAAACTTCAAATCCTTAATC\"\>"], "Output",
 CellChangeTimes->{3.818781378904387*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"90c5c4e0-a824-45d0-a732-8912814d1a51"],

Cell[BoxData["\<\"\
ACAACTCTCACTTCCAACTCACACATACCTTTACATCTCCTACACACACATTTACTCAAACATCTATCAACAAACCTT\
TCTCCTTCAACCTAACTCTCTCTACTCCACTACATAACCAAACACCAATCTCACAATCATCATTCCATTTCACAAAAC\
TTCAAATCCTTAATC\"\>"], "Output",
 CellChangeTimes->{3.818781378908637*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"e71e00e4-e0a7-412d-8fc6-18a6cebdf1a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"spaceIndex", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"8", ",", "15", ",", "22"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"34", "i"}], "+", "22", "+", "7"}], ",", 
          RowBox[{
           RowBox[{"34", "i"}], "+", "22", "+", 
           RowBox[{"7", "*", "2"}]}], ",", 
          RowBox[{
           RowBox[{"34", "i"}], "+", "22", "+", 
           RowBox[{"7", "*", "3"}], "-", "1"}], ",", 
          RowBox[{
           RowBox[{"34", "i"}], "+", "22", "+", 
           RowBox[{"7", "*", "4"}], "-", "1"}], ",", 
          RowBox[{
           RowBox[{"34", "i"}], "+", "22", "+", 
           RowBox[{"7", "*", "5"}], "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "165", "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spaceBottom", "=", 
    RowBox[{"StringInsert", "[", 
     RowBox[{"bottom", ",", "\"\< \>\"", ",", "spaceIndex"}], "]"}]}], ";"}], 
  
  RowBox[{"(*", 
   RowBox[{"add", " ", "space", " ", "to", " ", "bottom", " ", "strand"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<bottom: \>\"", ",", "spaceBottom"}], "]"}]}], "Input",
 CellChangeTimes->{{3.818781157627654*^9, 3.8187811855087442`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"f4f4c8a4-6c2c-4d51-bcee-753b9c074f92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bottom: \"\>", 
   "\[InvisibleSpace]", "\<\"ACAACTC TCACTTC CAACTCA CACATAC CTTTACA TCTCCT \
ACACACA CATTTAC TCAAACA TCTATCA ACAAAC CTTTCTC CTTCAAC CTAACTC TCTCTAC TCCACT \
ACATAAC CAAACAC CAATCTC ACAATCA TCATTC CATTTCA CAAAACT TCAAATC CTTAATC\"\>"}],
  
  SequenceForm[
  "bottom: ", 
   "ACAACTC TCACTTC CAACTCA CACATAC CTTTACA TCTCCT ACACACA CATTTAC TCAAACA \
TCTATCA ACAAAC CTTTCTC CTTCAAC CTAACTC TCTCTAC TCCACT ACATAAC CAAACAC CAATCTC \
ACAATCA TCATTC CATTTCA CAAAACT TCAAATC CTTAATC"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8187811633293743`*^9, 3.818781186453267*^9}, 
   3.818781378923999*^9},
 CellLabel->
  "During evaluation of \
In[197]:=",ExpressionUUID->"c376cef4-88e7-4d77-bbae-0128876fce9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"domain", "=", 
  RowBox[{
   RowBox[{"StringSplit", "[", "spaceBottom", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"4", ";;"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818781190266574*^9, 3.818781229800062*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"88ffc742-6c80-4048-a89c-56edc7fa04b7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"CACATAC\"\>", ",", "\<\"CTTTACA\"\>", ",", "\<\"TCTCCT\"\>", 
   ",", "\<\"ACACACA\"\>", ",", "\<\"CATTTAC\"\>", ",", "\<\"TCAAACA\"\>", 
   ",", "\<\"TCTATCA\"\>", ",", "\<\"ACAAAC\"\>", ",", "\<\"CTTTCTC\"\>", 
   ",", "\<\"CTTCAAC\"\>", ",", "\<\"CTAACTC\"\>", ",", "\<\"TCTCTAC\"\>", 
   ",", "\<\"TCCACT\"\>", ",", "\<\"ACATAAC\"\>", ",", "\<\"CAAACAC\"\>", 
   ",", "\<\"CAATCTC\"\>", ",", "\<\"ACAATCA\"\>", ",", "\<\"TCATTC\"\>", 
   ",", "\<\"CATTTCA\"\>", ",", "\<\"CAAAACT\"\>", ",", "\<\"TCAAATC\"\>", 
   ",", "\<\"CTTAATC\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.818781202921708*^9, 3.818781231400881*^9}, 
   3.818781378950954*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"b6cd03f5-5cb7-4b48-97b6-f01003a125cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cellseq", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"domain", "[", 
        RowBox[{"[", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
       RowBox[{"domain", "[", 
        RowBox[{"[", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
       RowBox[{"domain", "[", 
        RowBox[{"[", 
         RowBox[{"3", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
       RowBox[{"domain", "[", 
        RowBox[{"[", 
         RowBox[{"4", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
       RowBox[{"domain", "[", 
        RowBox[{"[", 
         RowBox[{"5", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818781444231008*^9, 3.81878147744209*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"18bb7a49-cc53-46a2-8d16-a9e458a1e31a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"CACATACCTTTACATCTCCTACACACACATTTAC\"\>", 
   ",", "\<\"TCAAACATCTATCAACAAACCTTTCTCCTTCAAC\"\>", 
   ",", "\<\"CTAACTCTCTCTACTCCACTACATAACCAAACAC\"\>", 
   ",", "\<\"CAATCTCACAATCATCATTCCATTTCACAAAACT\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.818781480484475*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"24959388-b34c-45ab-bd0e-fb3bfbf7d6d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assign mismatch", "Section",
 CellChangeTimes->{{3.817139386096298*^9, 
  3.817139389980912*^9}},ExpressionUUID->"c36a87ff-21ae-494f-ba3e-\
8ed32c981a28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"screenseq", "[", "s_", "]"}], ":=", 
  RowBox[{"StringCases", "[", 
   RowBox[{"s", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_", "~~", "\"\<A\>\"", "~~", "_"}], ",", 
      RowBox[{"_", "~~", "\"\<T\>\"", "~~", "_"}], ",", 
      RowBox[{"_", "~~", "\"\<CC\>\""}], ",", 
      RowBox[{"_", "~~", "\"\<CT\>\""}]}], "}"}], ",", 
    RowBox[{"Overlaps", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.817537647057757*^9, 3.817537668318296*^9}, {
  3.817538426893744*^9, 3.817538429906548*^9}, {3.817538509941805*^9, 
  3.8175385755168123`*^9}, {3.8175439382785807`*^9, 3.817543967607585*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"cdd06302-9c16-4337-94c3-ffbab4f39652"],

Cell["\<\
Look up table from Dave Zhang' s 2001 paper .
Since changing from A to G and T to G has smaller average free energy change, \
only A->G and T->G tables are used.\
\>", "Text",
 CellChangeTimes->{{3.817536473048048*^9, 
  3.817536543127104*^9}},ExpressionUUID->"86466daa-90e2-495d-9472-\
e80985a82d2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"keya", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"StringJoin", ",", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<A\>\"", ",", "\"\<G\>\"", ",", "\"\<C\>\"", ",", "\"\<T\>\""}], 
         "}"}], ",", 
        RowBox[{"{", "\"\<A\>\"", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<A\>\"", ",", "\"\<G\>\"", ",", "\"\<C\>\"", ",", "\"\<T\>\""}], 
         "}"}]}], "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valuea", "=", 
   RowBox[{"{", 
    RowBox[{
    "3.05", ",", "2.67", ",", "2.56", ",", "2.66", ",", "2.72", ",", "2.34", 
     ",", "2.23", ",", "2.33", ",", "2.32", ",", "1.94", ",", "1.83", ",", 
     "1.93", ",", "2.35", ",", "1.97", ",", "1.86", ",", "1.96"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keyt", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"StringJoin", ",", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<A\>\"", ",", "\"\<G\>\"", ",", "\"\<C\>\"", ",", "\"\<T\>\""}], 
         "}"}], ",", 
        RowBox[{"{", "\"\<T\>\"", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<A\>\"", ",", "\"\<G\>\"", ",", "\"\<C\>\"", ",", "\"\<T\>\""}], 
         "}"}]}], "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valuet", "=", 
   RowBox[{"{", 
    RowBox[{
    "1.9", ",", "2.38", ",", "1.95", ",", "2.04", ",", "1.92", ",", "2.4", 
     ",", "1.97", ",", "2.06", ",", "2.39", ",", "2.87", ",", "2.44", ",", 
     "2.53", ",", "2.74", ",", "3.22", ",", "2.79", ",", "2.88"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keyc", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<ACC\>\"", ",", "\"\<ACT\>\"", ",", "\"\<GCC\>\"", ",", "\"\<GCT\>\"",
      ",", "\"\<CCC\>\"", ",", "\"\<CCT\>\"", ",", "\"\<TCC\>\"", ",", 
     "\"\<TCT\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valuec", "=", 
   RowBox[{"{", 
    RowBox[{
    "2.04", ",", "2.46", ",", "1.86", ",", "2.28", ",", "2.46", ",", "2.88", 
     ",", "2.47", ",", "2.89"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"keya", ",", "valuea", ",", "keyt", ",", "valuet"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<From A to G: sequence\>\"", ",", "\"\<energy change\>\"", ",", 
         "\"\<From T to G: sequence\>\"", ",", "\"\<energy change\>\""}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"keyc", ",", "valuec"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<From C to G: sequence\>\"", ",", "\"\<energy change\>\""}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"key", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"keya", ",", "keyt", ",", "keyc"}], "]"}]}], ";", 
  RowBox[{"value", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"valuea", ",", "valuet", ",", "valuec"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mismatch", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"key", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
       RowBox[{"value", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "value", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.817536563304893*^9, 3.8175365732560167`*^9}, {
  3.817536635434278*^9, 3.817536640033437*^9}, {3.817536842385252*^9, 
  3.817536926734879*^9}, {3.817536969396812*^9, 3.817537034273973*^9}, {
  3.81753712787088*^9, 3.817537183422168*^9}, {3.817537262737465*^9, 
  3.817537264202235*^9}, {3.817537300651699*^9, 3.817537323146041*^9}, {
  3.817537388548452*^9, 3.817537392107704*^9}, {3.817537433429831*^9, 
  3.817537441676787*^9}, {3.817537494183756*^9, 3.8175376107896843`*^9}, {
  3.8175437397212*^9, 3.817543927832513*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"7c082467-06ce-4658-b5a1-0749e5c0d12c"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"From A to G: sequence\"\>", "\<\"AAA\"\>", "\<\"AAG\"\>", \
"\<\"AAC\"\>", "\<\"AAT\"\>", "\<\"GAA\"\>", "\<\"GAG\"\>", "\<\"GAC\"\>", \
"\<\"GAT\"\>", "\<\"CAA\"\>", "\<\"CAG\"\>", "\<\"CAC\"\>", "\<\"CAT\"\>", \
"\<\"TAA\"\>", "\<\"TAG\"\>", "\<\"TAC\"\>", "\<\"TAT\"\>"},
    {"\<\"energy change\"\>", "3.05`", "2.67`", "2.56`", "2.66`", "2.72`", 
     "2.34`", "2.23`", "2.33`", "2.32`", "1.94`", "1.83`", "1.93`", "2.35`", 
     "1.97`", "1.86`", "1.96`"},
    {"\<\"From T to G: sequence\"\>", "\<\"ATA\"\>", "\<\"ATG\"\>", \
"\<\"ATC\"\>", "\<\"ATT\"\>", "\<\"GTA\"\>", "\<\"GTG\"\>", "\<\"GTC\"\>", \
"\<\"GTT\"\>", "\<\"CTA\"\>", "\<\"CTG\"\>", "\<\"CTC\"\>", "\<\"CTT\"\>", \
"\<\"TTA\"\>", "\<\"TTG\"\>", "\<\"TTC\"\>", "\<\"TTT\"\>"},
    {"\<\"energy change\"\>", "1.9`", "2.38`", "1.95`", "2.04`", "1.92`", 
     "2.4`", "1.97`", "2.06`", "2.39`", "2.87`", "2.44`", "2.53`", "2.74`", 
     "3.22`", "2.79`", "2.88`"}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.8175373031345577`*^9, 3.8175373237971153`*^9}, 
   3.817537393324608*^9, 3.817537443990755*^9, 3.817537529397567*^9, {
   3.817537588824168*^9, 3.8175376111931343`*^9}, {3.81754389642209*^9, 
   3.817543928229939*^9}, 3.817559306529121*^9, 3.81877695107766*^9, 
   3.818781534335903*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"6b981adb-c66d-4c8f-bebe-c917f1151433"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"From C to G: sequence\"\>", "\<\"ACC\"\>", "\<\"ACT\"\>", \
"\<\"GCC\"\>", "\<\"GCT\"\>", "\<\"CCC\"\>", "\<\"CCT\"\>", "\<\"TCC\"\>", \
"\<\"TCT\"\>"},
    {"\<\"energy change\"\>", "2.04`", "2.46`", "1.86`", "2.28`", "2.46`", 
     "2.88`", "2.47`", "2.89`"}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.8175373031345577`*^9, 3.8175373237971153`*^9}, 
   3.817537393324608*^9, 3.817537443990755*^9, 3.817537529397567*^9, {
   3.817537588824168*^9, 3.8175376111931343`*^9}, {3.81754389642209*^9, 
   3.817543928229939*^9}, 3.817559306529121*^9, 3.81877695107766*^9, 
   3.818781534342525*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"407095b2-f7c4-4689-b4e2-73668f8809f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "top", " ", "sequence", " ", "at", " ", "domain", " ", "2", " ", "for", 
    " ", "each", " ", "cell"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"seq2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"complement", "[", 
       RowBox[{"domain", "[", 
        RowBox[{"[", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"seq123", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"complement", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"domain", "[", 
           RowBox[{"[", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"domain", "[", 
           RowBox[{"[", 
            RowBox[{"2", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"domain", "[", 
           RowBox[{"[", 
            RowBox[{"3", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}]}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.817535890640037*^9, 3.817535996533471*^9}, {
   3.817538704313489*^9, 3.817538711457111*^9}, {3.8175387485207367`*^9, 
   3.8175387523325787`*^9}, 3.817539027202587*^9, {3.817539059443388*^9, 
   3.817539065099193*^9}, {3.817539742738886*^9, 3.817539789564275*^9}, {
   3.818777210914534*^9, 3.818777211077097*^9}, {3.81877727403403*^9, 
   3.818777330818137*^9}, {3.8187773751458797`*^9, 3.818777411821664*^9}, {
   3.818781545882526*^9, 3.818781578172874*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"1413ba7d-b09c-4c16-8b87-88b91c8f7a36"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"TGTAAAG\"\>", ",", "\<\"TGATAGA\"\>", ",", "\<\"GTAGAGA\"\>", 
   ",", "\<\"TGATTGT\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.8187774122773*^9, 3.818781584146841*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"1a5ed671-002e-4692-9d8f-e72eaf9aa531"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "screen", " ", "sequence", " ", "to", " ", "find", " ", "mismatch", " ", 
    "location"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"seq123", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ",", 
      RowBox[{"mismatch", "[", 
       RowBox[{"[", 
        RowBox[{"screenseq", "[", 
         RowBox[{"seq2", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8175387375767183`*^9, 3.8175387692631187`*^9}, {
   3.817539033456736*^9, 3.8175390445612297`*^9}, {3.8175390791067953`*^9, 
   3.8175391585899878`*^9}, {3.817539237721162*^9, 3.8175393096861897`*^9}, {
   3.817539363726782*^9, 3.817539365020833*^9}, {3.817539809389222*^9, 
   3.817539815197736*^9}, {3.817541993508494*^9, 3.8175420282262917`*^9}, 
   3.81755033375828*^9, {3.818777349880621*^9, 3.818777397810637*^9}, {
   3.818781601100029*^9, 3.818781618225759*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"6a84265d-0519-4534-83c9-d0d6727e2da8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"AGGAGATGTAAAGGTATGTG\"\>", ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"GTA\"\>", "\[Rule]", "1.92`"}], ",", 
       RowBox[{"\<\"TAA\"\>", "\[Rule]", "2.35`"}], ",", 
       RowBox[{"\<\"AAA\"\>", "\[Rule]", "3.05`"}], ",", 
       RowBox[{"\<\"AAG\"\>", "\[Rule]", "2.67`"}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"GTTTGTTGATAGATGTTTGA\"\>", ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"GAT\"\>", "\[Rule]", "2.33`"}], ",", 
       RowBox[{"\<\"ATA\"\>", "\[Rule]", "1.9`"}], ",", 
       RowBox[{"\<\"TAG\"\>", "\[Rule]", "1.97`"}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"AGTGGAGTAGAGAGAGTTAG\"\>", ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"GTA\"\>", "\[Rule]", "1.92`"}], ",", 
       RowBox[{"\<\"TAG\"\>", "\[Rule]", "1.97`"}], ",", 
       RowBox[{"\<\"GAG\"\>", "\[Rule]", "2.34`"}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"GAATGATGATTGTGAGATTG\"\>", ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"GAT\"\>", "\[Rule]", "2.33`"}], ",", 
       RowBox[{"\<\"ATT\"\>", "\[Rule]", "2.04`"}], ",", 
       RowBox[{"\<\"TTG\"\>", "\[Rule]", "3.22`"}]}], 
      "\[RightAssociation]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8187773958788443`*^9, 3.818777398407503*^9}, 
   3.818781623696446*^9},
 CellLabel->
  "Out[214]=",ExpressionUUID->"485f9035-4c7f-4b89-be59-b9b7c39d1596"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "mismatch", " ", "location", " ", "is", " ", "manually", " ", "found", " ",
     "by", " ", "optimizing", " ", "energy"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"before", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<GTA\>\"", ",", "\"\<ATA\>\"", ",", "\"\<GTA\>\"", ",", 
       "\"\<ATT\>\""}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"after", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"x_", "~~", "\"\<A\>\"", "~~", "y_"}], "\[Rule]", 
            RowBox[{"x", "~~", "\"\<G\>\"", "~~", "y"}]}], ",", 
           RowBox[{
            RowBox[{"x_", "~~", "\"\<T\>\"", "~~", "y_"}], "->", 
            RowBox[{"x", "~~", "\"\<G\>\"", "~~", "y"}]}], ",", 
           RowBox[{
            RowBox[{"x_", "~~", "\"\<C\>\"", "~~", "y_"}], "->", 
            RowBox[{"x", "~~", "\"\<G\>\"", "~~", "y"}]}]}], "}"}]}], "]"}], 
       "&"}], "/@", "before"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.817541847859321*^9, 3.817541853580271*^9}, {
   3.81754195856324*^9, 3.8175419817230167`*^9}, {3.817542029863345*^9, 
   3.817542139621217*^9}, {3.8175422595849667`*^9, 3.817542266572309*^9}, {
   3.817542445490896*^9, 3.8175424470506573`*^9}, {3.817542782441226*^9, 
   3.817542881891469*^9}, {3.817542935899665*^9, 3.817542999305654*^9}, {
   3.817543037190938*^9, 3.817543066495393*^9}, {3.81754313625448*^9, 
   3.8175432484974937`*^9}, {3.817543282938961*^9, 3.817543285674404*^9}, {
   3.817543323519538*^9, 3.817543355672658*^9}, {3.81754339165725*^9, 
   3.81754339384091*^9}, {3.817543433354765*^9, 3.817543435530629*^9}, {
   3.817544011497444*^9, 3.81754402106555*^9}, {3.81754412860631*^9, 
   3.817544130629642*^9}, {3.817544464388609*^9, 3.8175445117815857`*^9}, 
   3.817544612000318*^9, {3.817544725658987*^9, 3.8175447270831633`*^9}, 
   3.817545351205905*^9, {3.817545632002882*^9, 3.8175456374741077`*^9}, {
   3.8175456778758173`*^9, 3.817545679915427*^9}, {3.817545736869217*^9, 
   3.8175457593175917`*^9}, {3.8175459946501007`*^9, 
   3.8175460043223257`*^9}, {3.817546043586741*^9, 3.817546047936658*^9}, {
   3.817546116473673*^9, 3.817546149186759*^9}, {3.817546184939629*^9, 
   3.817546187859664*^9}, {3.8175465061368217`*^9, 3.8175465138889513`*^9}, {
   3.817546557779554*^9, 3.8175465603940477`*^9}, {3.817546818249807*^9, 
   3.817546820238571*^9}, {3.817546880610992*^9, 3.817546882601904*^9}, {
   3.81754691371537*^9, 3.817546916858904*^9}, {3.817546981602585*^9, 
   3.817547014554356*^9}, {3.817547074876964*^9, 3.81754707673213*^9}, {
   3.8175471308619137`*^9, 3.8175471313732557`*^9}, 3.817547348735338*^9, {
   3.817547485713375*^9, 3.81754748609083*^9}, {3.8175495371295223`*^9, 
   3.817549540958005*^9}, {3.818777429237153*^9, 3.8187775187742243`*^9}, {
   3.818777585600513*^9, 3.818777652728766*^9}, {3.818781662556222*^9, 
   3.8187817007568197`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"20046954-0704-4168-b82b-ec1e295dce0d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"flat123", "=", 
   RowBox[{"Flatten", "[", "seq123", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"applychange", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"StringSplit", "[", 
      RowBox[{
       RowBox[{"flat123", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"before", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"after", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], ",", 
          "StandardForm"}], "]"}]}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "flat123", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.817547297240808*^9, 3.817547341524413*^9}, {
  3.8175474018638268`*^9, 3.8175475363743763`*^9}, {3.8175477187780733`*^9, 
  3.8175477526821833`*^9}, {3.817547787158167*^9, 3.817547806214699*^9}, {
  3.817547893918095*^9, 3.817547900893395*^9}, {3.81754793959201*^9, 
  3.817547941655916*^9}, {3.817548162724984*^9, 3.81754821593325*^9}, {
  3.8175482679216146`*^9, 3.8175483024741173`*^9}, {3.81754838727433*^9, 
  3.81754839251262*^9}, {3.81877766557012*^9, 3.818777674520646*^9}, {
  3.818777705803701*^9, 3.818777706793789*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"cdd0dcc8-0a3f-40db-b0b9-440577e8f64a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"AGGAGAT\\!\\(\\*StyleBox[\\\"\\\\\\\"GGA\\\\\\\"\\\", \
Rule[FontColor, RGBColor[1, 0, 0]], Rule[StripOnInput, \
False]]\\)AAG\\!\\(\\*StyleBox[\\\"\\\\\\\"GGA\\\\\\\"\\\", Rule[FontColor, \
RGBColor[1, 0, 0]], Rule[StripOnInput, False]]\\)TGTG\"\>", 
   ",", "\<\"GTTTGTTG\\!\\(\\*StyleBox[\\\"\\\\\\\"AGA\\\\\\\"\\\", \
Rule[FontColor, RGBColor[1, 0, 0]], Rule[StripOnInput, \
False]]\\)GATGTTTGA\"\>", 
   ",", "\<\"AGTGGA\\!\\(\\*StyleBox[\\\"\\\\\\\"GGA\\\\\\\"\\\", \
Rule[FontColor, RGBColor[1, 0, 0]], Rule[StripOnInput, \
False]]\\)GAGAGAGTTAG\"\>", 
   ",", "\<\"GAATGATG\\!\\(\\*StyleBox[\\\"\\\\\\\"AGT\\\\\\\"\\\", \
Rule[FontColor, RGBColor[1, 0, 0]], Rule[StripOnInput, \
False]]\\)GTGAG\\!\\(\\*StyleBox[\\\"\\\\\\\"AGT\\\\\\\"\\\", Rule[FontColor, \
RGBColor[1, 0, 0]], Rule[StripOnInput, False]]\\)G\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8175474511646643`*^9, {3.817547519637293*^9, 3.8175475369215107`*^9}, {
   3.817547719293882*^9, 3.817547753481604*^9}, {3.817547787654941*^9, 
   3.817547806856399*^9}, 3.817547904279097*^9, 3.817547942261697*^9, 
   3.817548252169245*^9, 3.81754830365421*^9, 3.817548392968383*^9, 
   3.817549552768202*^9, 3.817550396936493*^9, 3.817559306633412*^9, {
   3.818777701039083*^9, 3.818777707353138*^9}, 3.818781712500996*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"4ece7a98-67c0-40ee-bd4c-4d05cfb03297"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroLseq", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<AGGAGATGGAAAGGTATGTG\>\"", ",", "\"\<GTTTGTTGAGAGATGTTTGA\>\"", ",", 
     "\"\<AGTGGAGGAGAGAGAGTTAG\>\"", ",", "\"\<GAATGATGAGTGTGAGATTG\>\""}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.817548400595677*^9, 3.8175485481163816`*^9}, {
  3.817548589416211*^9, 3.817548751415942*^9}, {3.817548781721949*^9, 
  3.81754922625309*^9}, {3.8175495752637167`*^9, 3.817549583326632*^9}, {
  3.817549757121472*^9, 3.817549761688079*^9}, {3.8175499139745407`*^9, 
  3.8175499271644297`*^9}, {3.817549957977642*^9, 3.817549959142583*^9}, {
  3.817550367243196*^9, 3.81755036774691*^9}, {3.818777730168322*^9, 
  3.818777790732024*^9}, {3.818777849070889*^9, 3.818777948172723*^9}, {
  3.818777990335824*^9, 3.818778116739214*^9}, {3.818781724677692*^9, 
  3.818781804698929*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"166ae665-4c38-4bf5-bcd0-1548372b5b3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"sanity", " ", "check", " ", "for", " ", "mismatch"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"vienna2strand", "[", 
       RowBox[{
        RowBox[{"zeroLseq", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"cellseq", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "zeroLseq", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.817549962030418*^9, 3.8175500341791353`*^9}, 
   3.817550147809575*^9, {3.8175503061270123`*^9, 3.8175503063847313`*^9}, {
   3.817550372307273*^9, 3.817550372698924*^9}, 3.818778142041073*^9, {
   3.8187783164741573`*^9, 3.818778317604233*^9}, {3.818778349048036*^9, 
   3.818778350925663*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"a4756a5a-67a4-4e42-bae3-45192ad349d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
     "{", "\<\"((((((((.(((((((((((&))))))))))).)))))))).   1,20  :   1,21  \
(-22.22)\"\>", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{
     "{", "\<\"(((((((((.(((((((((.&.))))))))).))))))))).   1,20  :   1,21  \
(-23.02)\"\>", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{
     "{", "\<\"(((((((.((((((((((((&)))))))))))).))))))).   1,20  :   1,21  \
(-22.12)\"\>", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{
     "{", "\<\"(((((((((.((((((((((&)))))))))).))))))))).   1,20  :   1,21  \
(-22.66)\"\>", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.817550035859662*^9, 3.8175501497903423`*^9, 3.817550308113196*^9, 
   3.8175503979550543`*^9, {3.8175593076928453`*^9, 3.8175593297150784`*^9}, 
   3.818778328886407*^9, 3.8187818473715763`*^9},
 CellLabel->
  "Out[220]=",ExpressionUUID->"d87629eb-4c85-45d1-8794-e58d9c729598"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroLname", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<Rule_cell\>\"", ",", 
        RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<_zeroL\>\""}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.817535790323656*^9, 3.817535868296832*^9}, {
  3.817585360755445*^9, 3.817585363626676*^9}, {3.817585407234729*^9, 
  3.817585410658633*^9}, {3.817585725757983*^9, 3.817585737547593*^9}, {
  3.818778161568871*^9, 3.818778175669107*^9}, {3.818778437938074*^9, 
  3.818778504749771*^9}, {3.818781861562697*^9, 3.818781883077526*^9}, {
  3.818781952119761*^9, 3.8187819524303293`*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"189137c3-9e64-4a92-9a74-d0906edc4d9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroL", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zeroLname", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\</5Phos/\>\"", ",", 
         RowBox[{"zeroLseq", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.817585385930779*^9, 3.817585386488641*^9}, {
   3.81758542219695*^9, 3.8175854545485888`*^9}, {3.817585707700906*^9, 
   3.8175857468752117`*^9}, {3.8175857971407413`*^9, 3.817585899922475*^9}, {
   3.81758594558575*^9, 3.817585980935936*^9}, 3.817586156562174*^9, {
   3.818778179809002*^9, 3.818778194396646*^9}, {3.818778439457384*^9, 
   3.8187784395520277`*^9}, {3.818778507647769*^9, 3.818778513536181*^9}, {
   3.818781907160207*^9, 3.8187819410113077`*^9}, {3.8187820499426126`*^9, 
   3.81878210456808*^9}, {3.8187828718469677`*^9, 3.8187828793321247`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"0c02cd42-3fa7-4db3-8663-1a35b1ea7b36"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Combine sequence", "Section",
 CellChangeTimes->{{3.817139365045691*^9, 
  3.8171393759726067`*^9}},ExpressionUUID->"096b0b6f-4546-423f-99ec-\
e214058c005b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeroRname", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<Rule_cell\>\"", ",", 
        RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<_zeroR\>\""}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroRseq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\</5Phos/\>\"", ",", 
       RowBox[{"complement", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"domain", "[", 
           RowBox[{"[", 
            RowBox[{"4", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"domain", "[", 
           RowBox[{"[", 
            RowBox[{"5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}]}], 
         "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817583583926916*^9, 3.817583679463879*^9}, {
  3.817583730713933*^9, 3.817583808892839*^9}, {3.81877683605639*^9, 
  3.818776836318934*^9}, {3.818778197454836*^9, 3.818778208742378*^9}, {
  3.818778519800563*^9, 3.818778556312805*^9}, {3.818781981391868*^9, 
  3.818781986120261*^9}, {3.8187821173069696`*^9, 3.818782168737112*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"ea9332c4-f494-44ce-a48d-f3a81aeadbc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroR", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zeroRname", ",", "zeroRseq"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.817583827435021*^9, 3.817583828243911*^9}, {
   3.817583948214427*^9, 3.81758405630933*^9}, {3.817584112648645*^9, 
   3.817584124231824*^9}, {3.8187785583941307`*^9, 3.818778569041095*^9}, 
   3.8187821106796827`*^9, {3.8187821550554857`*^9, 3.818782175089588*^9}, {
   3.8187826965840063`*^9, 3.81878269943893*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"0ca415e6-09ab-423a-8640-58f1e7194e7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"onename", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<Rule_cell\>\"", ",", 
       RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<_one\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oneseq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"complement", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"domain", "[", 
         RowBox[{"[", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
        
        RowBox[{"domain", "[", 
         RowBox[{"[", 
          RowBox[{"3", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
        
        RowBox[{"domain", "[", 
         RowBox[{"[", 
          RowBox[{"4", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], ",", 
        
        RowBox[{"domain", "[", 
         RowBox[{"[", 
          RowBox[{"5", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}]}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817585101471551*^9, 3.817585173155439*^9}, {
  3.818778603067842*^9, 3.8187786564461813`*^9}, {3.8187787679931803`*^9, 
  3.818778770121748*^9}, {3.8187821900740633`*^9, 3.818782196380938*^9}, {
  3.818782251181913*^9, 3.818782273101832*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"c980877f-76cf-4016-a230-9c29f55b2e68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"one", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"onename", ",", "oneseq"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.817585180833851*^9, 3.817585202017419*^9}, 
   3.817585297337544*^9, {3.818778776513021*^9, 3.818778783663302*^9}, {
   3.818782283489114*^9, 3.818782312360086*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"3b3bd386-4aa9-4ef3-95ac-5649ed1f1c0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sealname", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<Rule_sealcell\>\"", ",", 
         RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sealseq", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\</5Phos/\>\"", ",", 
         RowBox[{"complement", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"2", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"3", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"4", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"5", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}]}],
            "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.818778693445703*^9, 3.8187787515967407`*^9}, {
  3.818778798160492*^9, 3.8187787982961493`*^9}, {3.8187807150549183`*^9, 
  3.818780723892829*^9}, {3.81878077076894*^9, 3.818780781070273*^9}, {
  3.818782323040107*^9, 3.818782371048774*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"45e5d34f-9f5f-46d1-89b5-fd65d8d77e9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seal", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"sealname", ",", "sealseq"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.818778810856824*^9, 3.818778852410759*^9}, {
  3.818780785832876*^9, 3.8187808287280827`*^9}, {3.818782373914942*^9, 
  3.818782379641735*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"83cdf519-c2b7-4c73-b1a1-f6eb5799a0cd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"complement", "[", 
     RowBox[{"StringTake", "[", 
      RowBox[{"Alldomains", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "*", "7"}], "+", "1"}], ",", 
         RowBox[{"2", "*", "7"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"domain", " ", "2", " ", "from", " ", "Alldomains"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<domain b: \>\"", ",", "b"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{"complement", "[", 
     RowBox[{"StringTake", "[", 
      RowBox[{"Alldomains", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", "7"}], "+", "1"}], ",", 
         RowBox[{"3", "*", "7"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"domain", " ", "3", " ", "from", " ", "Alldomains"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<domain a: \>\"", ",", "a"}], "]"}]}], "Input",
 CellLabel->
  "In[247]:=",ExpressionUUID->"2d1b2101-6c65-4d5f-ab61-029ec4046cdd"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"domain b: \"\>", "\[InvisibleSpace]", "\<\"AGGATGA\"\>"}],
  SequenceForm["domain b: ", "AGGATGA"],
  Editable->False]], "Print",
 CellChangeTimes->{3.818782539416903*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"ae8dc106-9e05-4724-b66b-1ec0ea3f24e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"domain a: \"\>", "\[InvisibleSpace]", "\<\"AGAAAGA\"\>"}],
  SequenceForm["domain a: ", "AGAAAGA"],
  Editable->False]], "Print",
 CellChangeTimes->{3.818782539420479*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"a10ce18b-254b-42c6-b00f-54ebab201519"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"instru1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<Rule_instru1\>\"", ",", 
         RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"a", ",", 
         RowBox[{"complement", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"4", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"5", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"domain", "[", 
             RowBox[{"[", 
              RowBox[{"6", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "5"}]}], "]"}], "]"}]}],
            "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.81714395177428*^9, 3.8171439570294657`*^9}, {
   3.817144064119452*^9, 3.817144071842965*^9}, {3.817144387421269*^9, 
   3.8171443980125504`*^9}, 3.817144431856971*^9, {3.81714449640648*^9, 
   3.8171446016767197`*^9}, 3.817213795853465*^9, {3.817532423375465*^9, 
   3.817532436672591*^9}, 3.8175329567995243`*^9, 3.817533064339179*^9, 
   3.817533547386977*^9, {3.817533649577716*^9, 3.817533652993395*^9}, 
   3.8175338367442904`*^9, {3.817534321538014*^9, 3.817534359441209*^9}, {
   3.8175344246691113`*^9, 3.817534430048354*^9}, {3.817534661827146*^9, 
   3.817534663797414*^9}, {3.8187792204237843`*^9, 3.818779232899296*^9}, {
   3.818779278187847*^9, 3.818779281835188*^9}, 3.8187793408287582`*^9, {
   3.818779374749309*^9, 3.818779378162879*^9}, {3.818779462460552*^9, 
   3.818779511091095*^9}, {3.81877965741649*^9, 3.818779757026186*^9}, {
   3.818782390809577*^9, 3.818782391865892*^9}, {3.8187825612278433`*^9, 
   3.818782611210135*^9}, {3.8187826613905687`*^9, 3.818782683802558*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"28954cc8-867c-4d95-8270-454d2268348c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"instru5name", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<Rule_instru5\>\"", ",", 
        RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"instru5seq", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"complement", "[", 
      RowBox[{
       RowBox[{"instru1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "instru1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.817533418187236*^9, 3.817533420680628*^9}, {
  3.817534809349568*^9, 3.817534880934527*^9}, {3.818779750507921*^9, 
  3.818779849234353*^9}, {3.818782619969784*^9, 3.818782624282089*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"ff3cf336-b7f1-4859-a2d3-c4161a2251b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"instru5", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"instru5name", ",", "instru5seq"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.817534883864912*^9, 3.817534925198279*^9}, 
   3.8175350317621*^9, 3.818779805865844*^9, {3.81877983937141*^9, 
   3.818779850571095*^9}, {3.818782689110259*^9, 3.8187826915237627`*^9}, {
   3.818782974302258*^9, 3.818782976033506*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"d03c8917-2ca1-41da-9f1d-4f268b383285"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Strand Layout", "Section",
 CellChangeTimes->{{3.817139386096298*^9, 3.817139389980912*^9}, {
  3.8175504589893637`*^9, 3.817550469468759*^9}, {3.817556126444036*^9, 
  3.8175561300912046`*^9}},ExpressionUUID->"160d5641-9db7-47b9-bb01-\
ab6741c2b273"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/wangboya/Box/Research/SIMDDNA/sequences\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.818780407373518*^9, 3.818780421517563*^9}, {
  3.818782722628509*^9, 3.8187827237094927`*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"28d01e14-f22f-4695-819b-29c7cfb9fa51"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rule110", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "zeroL", ",", "zeroR", ",", "seal", ",", "one", ",", "instru1", ",", 
       "instru5"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<rule110.xlsx\>\"", ",", "rule110"}], "]"}]}], "Input",
 CellChangeTimes->{{3.818780004098795*^9, 3.818780083702249*^9}, {
   3.818780160753853*^9, 3.818780176920472*^9}, {3.818780835294002*^9, 
   3.818780836247649*^9}, {3.8187827403897457`*^9, 3.818782799965711*^9}, {
   3.818782844327876*^9, 3.8187828519736757`*^9}, 3.818782889261097*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"e77ff569-ef20-4cc4-8f61-454f183b2d69"],

Cell[BoxData["\<\"rule110.xlsx\"\>"], "Output",
 CellChangeTimes->{
  3.818780428418581*^9, 3.818780845526157*^9, {3.81878281891678*^9, 
   3.8187828447308283`*^9}, {3.818782886235368*^9, 3.81878289005103*^9}, 
   3.818782981841009*^9},
 CellLabel->
  "Out[281]=",ExpressionUUID->"e3fb37dc-5b44-4b2b-ac40-fc9d32f28001"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{956, 746},
WindowMargins->{{365, Automatic}, {169, Automatic}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"518f8ed8-11e8-4556-97f7-cc9bf625c0b0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 209, 4, 67, "Section",ExpressionUUID->"267bf28b-396c-440e-9cbe-a63cadce32a5"],
Cell[792, 28, 607, 15, 52, "Input",ExpressionUUID->"6118c5e8-4ea0-4a7b-b558-866799167c87"],
Cell[1402, 45, 284, 7, 30, "Input",ExpressionUUID->"d2d7097c-20f6-49df-b615-a3970312c8c5"],
Cell[1689, 54, 404, 12, 32, "Input",ExpressionUUID->"2780ea47-88f7-4847-8fc8-50f4b3dfd3c5"],
Cell[2096, 68, 481, 12, 30, "Input",ExpressionUUID->"329772c4-1159-49c0-bcca-fd2f4ae817d9"],
Cell[2580, 82, 430, 11, 30, "Input",ExpressionUUID->"b85b94fe-3632-4a21-b783-1dc233785b2f"],
Cell[3013, 95, 432, 11, 30, "Input",ExpressionUUID->"e2405bd8-7d3d-4ad9-a795-307e66258ddf"],
Cell[3448, 108, 428, 11, 30, "Input",ExpressionUUID->"048c0672-958a-4687-8862-3e38dfa39155"],
Cell[3879, 121, 404, 12, 32, "Input",ExpressionUUID->"6e10166b-af4c-43af-882f-a261f1172ca4"],
Cell[4286, 135, 526, 13, 32, "Input",ExpressionUUID->"68372a18-4d98-42ca-8904-fc99eaf1b2db"],
Cell[4815, 150, 774, 17, 30, "Input",ExpressionUUID->"4aa3c7f4-b730-45bb-af0a-82c56c788e7a"],
Cell[5592, 169, 416, 12, 52, "Input",ExpressionUUID->"2de1d091-e489-410f-b93c-524b83141084"],
Cell[6011, 183, 679, 17, 73, "Input",ExpressionUUID->"eb1bed4a-eda9-4ef1-9a52-81362ef12199"],
Cell[6693, 202, 427, 9, 35, "Text",ExpressionUUID->"f01743f1-a69d-417f-b6d0-b108f31bd023"],
Cell[7123, 213, 2524, 57, 262, "Input",ExpressionUUID->"8d2b10a0-f813-4c2a-a484-9335bb92f774"],
Cell[9650, 272, 4403, 94, 304, "Input",ExpressionUUID->"58a5295c-9b4a-44f4-a0d8-abef53ae1856"],
Cell[14056, 368, 3420, 82, 388, "Input",ExpressionUUID->"53a0fdea-377f-4484-b61a-258bad5a11a9"],
Cell[17479, 452, 3357, 75, 388, "Input",ExpressionUUID->"dcb3e41e-ea8a-4d53-8a61-a089516f811c"],
Cell[20839, 529, 2751, 66, 346, "Input",ExpressionUUID->"e0120a62-d3da-4890-b831-867b4acdfced"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23627, 600, 296, 4, 67, "Section",ExpressionUUID->"62792cea-b56e-4fe3-8c82-c02ef0753f54"],
Cell[23926, 606, 1027, 22, 136, "Input",ExpressionUUID->"68d60c30-8925-43b2-85a6-3492cdfbe16b"],
Cell[CellGroupData[{
Cell[24978, 632, 2601, 86, 157, "Input",ExpressionUUID->"16922e85-8cb3-4839-9d16-3971a8c52db6"],
Cell[27582, 720, 358, 6, 56, "Output",ExpressionUUID->"90c5c4e0-a824-45d0-a732-8912814d1a51"],
Cell[27943, 728, 337, 6, 56, "Output",ExpressionUUID->"e71e00e4-e0a7-412d-8fc6-18a6cebdf1a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28317, 739, 1568, 43, 136, "Input",ExpressionUUID->"f4f4c8a4-6c2c-4d51-bcee-753b9c074f92"],
Cell[29888, 784, 772, 17, 44, "Print",ExpressionUUID->"c376cef4-88e7-4d77-bbae-0128876fce9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30697, 806, 325, 8, 30, "Input",ExpressionUUID->"88ffc742-6c80-4048-a89c-56edc7fa04b7"],
Cell[31025, 816, 780, 13, 56, "Output",ExpressionUUID->"b6cd03f5-5cb7-4b48-97b6-f01003a125cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31842, 834, 1417, 42, 73, "Input",ExpressionUUID->"18bb7a49-cc53-46a2-8d16-a9e458a1e31a"],
Cell[33262, 878, 394, 8, 56, "Output",ExpressionUUID->"24959388-b34c-45ab-bd0e-fb3bfbf7d6d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33705, 892, 160, 3, 67, "Section",ExpressionUUID->"c36a87ff-21ae-494f-ba3e-8ed32c981a28"],
Cell[33868, 897, 735, 16, 30, "Input",ExpressionUUID->"cdd06302-9c16-4337-94c3-ffbab4f39652"],
Cell[34606, 915, 311, 7, 58, "Text",ExpressionUUID->"86466daa-90e2-495d-9472-e80985a82d2c"],
Cell[CellGroupData[{
Cell[34942, 926, 4528, 121, 262, "Input",ExpressionUUID->"7c082467-06ce-4658-b5a1-0749e5c0d12c"],
Cell[39473, 1049, 1553, 27, 97, "Output",ExpressionUUID->"6b981adb-c66d-4c8f-bebe-c917f1151433"],
Cell[41029, 1078, 883, 18, 59, "Output",ExpressionUUID->"407095b2-f7c4-4689-b4e2-73668f8809f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41949, 1101, 2158, 58, 94, "Input",ExpressionUUID->"1413ba7d-b09c-4c16-8b87-88b91c8f7a36"],
Cell[44110, 1161, 298, 6, 34, "Output",ExpressionUUID->"1a5ed671-002e-4692-9d8f-e72eaf9aa531"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44445, 1172, 1182, 27, 52, "Input",ExpressionUUID->"6a84265d-0519-4534-83c9-d0d6727e2da8"],
Cell[45630, 1201, 1667, 39, 98, "Output",ExpressionUUID->"485f9035-4c7f-4b89-be59-b9b7c39d1596"]
}, Open  ]],
Cell[47312, 1243, 3117, 60, 115, "Input",ExpressionUUID->"20046954-0704-4168-b82b-ec1e295dce0d"],
Cell[CellGroupData[{
Cell[50454, 1307, 1530, 35, 115, "Input",ExpressionUUID->"cdd0dcc8-0a3f-40db-b0b9-440577e8f64a"],
Cell[51987, 1344, 1420, 24, 34, "Output",ExpressionUUID->"4ece7a98-67c0-40ee-bd4c-4d05cfb03297"]
}, Open  ]],
Cell[53422, 1371, 952, 18, 30, "Input",ExpressionUUID->"166ae665-4c38-4bf5-bcd0-1548372b5b3c"],
Cell[CellGroupData[{
Cell[54399, 1393, 973, 24, 52, "Input",ExpressionUUID->"a4756a5a-67a4-4e42-bae3-45192ad349d3"],
Cell[55375, 1419, 1031, 28, 98, "Output",ExpressionUUID->"d87629eb-4c85-45d1-8794-e58d9c729598"]
}, Open  ]],
Cell[56421, 1450, 869, 19, 30, "Input",ExpressionUUID->"189137c3-9e64-4a92-9a74-d0906edc4d9d"],
Cell[57293, 1471, 1135, 24, 30, "Input",ExpressionUUID->"0c02cd42-3fa7-4db3-8663-1a35b1ea7b36"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58465, 1500, 163, 3, 67, "Section",ExpressionUUID->"096b0b6f-4546-423f-99ec-e214058c005b"],
Cell[58631, 1505, 1649, 44, 73, "Input",ExpressionUUID->"ea9332c4-f494-44ce-a48d-f3a81aeadbc8"],
Cell[60283, 1551, 597, 12, 30, "Input",ExpressionUUID->"0ca415e6-09ab-423a-8640-58f1e7194e7d"],
Cell[60883, 1565, 1822, 52, 94, "Input",ExpressionUUID->"c980877f-76cf-4016-a230-9c29f55b2e68"],
Cell[62708, 1619, 439, 10, 30, "Input",ExpressionUUID->"3b3bd386-4aa9-4ef3-95ac-5649ed1f1c0d"],
Cell[63150, 1631, 2409, 67, 136, "Input",ExpressionUUID->"45e5d34f-9f5f-46d1-89b5-fd65d8d77e9a"],
Cell[65562, 1700, 420, 10, 30, "Input",ExpressionUUID->"83cdf519-c2b7-4c73-b1a1-f6eb5799a0cd"],
Cell[CellGroupData[{
Cell[66007, 1714, 1162, 34, 94, "Input",ExpressionUUID->"2d1b2101-6c65-4d5f-ab61-029ec4046cdd"],
Cell[CellGroupData[{
Cell[67194, 1752, 326, 8, 24, "Print",ExpressionUUID->"ae8dc106-9e05-4724-b66b-1ec0ea3f24e9"],
Cell[67523, 1762, 326, 8, 24, "Print",ExpressionUUID->"a10ce18b-254b-42c6-b00f-54ebab201519"]
}, Open  ]]
}, Open  ]],
Cell[67876, 1774, 2386, 53, 94, "Input",ExpressionUUID->"28954cc8-867c-4d95-8270-454d2268348c"],
Cell[70265, 1829, 1057, 29, 52, "Input",ExpressionUUID->"ff3cf336-b7f1-4859-a2d3-c4161a2251b3"],
Cell[71325, 1860, 525, 12, 30, "Input",ExpressionUUID->"d03c8917-2ca1-41da-9f1d-4f268b383285"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71887, 1877, 257, 4, 67, "Section",ExpressionUUID->"160d5641-9db7-47b9-bb01-ab6741c2b273"],
Cell[72147, 1883, 346, 9, 30, "Input",ExpressionUUID->"28d01e14-f22f-4695-819b-29c7cfb9fa51"],
Cell[CellGroupData[{
Cell[72518, 1896, 750, 17, 52, "Input",ExpressionUUID->"e77ff569-ef20-4cc4-8f61-454f183b2d69"],
Cell[73271, 1915, 319, 6, 34, "Output",ExpressionUUID->"e3fb37dc-5b44-4b2b-ac40-fc9d32f28001"]
}, Open  ]]
}, Open  ]]
}
]
*)

